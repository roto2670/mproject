(function(e){function t(t){for(var s,a,r=t[0],o=t[1],l=t[2],d=0,h=[];d<r.length;d++)a=r[d],i[a]&&h.push(i[a][0]),i[a]=0;for(s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s]);u&&u(t);while(h.length)h.shift()();return c.push.apply(c,l||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],s=!0,r=1;r<n.length;r++){var o=n[r];0!==i[o]&&(s=!1)}s&&(c.splice(t--,1),e=a(a.s=n[0]))}return e}var s={},i={app:0},c=[];function a(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=s,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(n,s,function(t){return e[t]}.bind(null,s));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],o=r.push.bind(r);r.push=t,r=r.slice();for(var l=0;l<r.length;l++)t(r[l]);var u=o;c.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0174":function(e,t,n){"use strict";var s=n("a269"),i=n.n(s);i.a},"034f":function(e,t,n){"use strict";var s=n("64a9"),i=n.n(s);i.a},"0557":function(e,t,n){"use strict";var s=n("1202"),i=n.n(s);i.a},1202:function(e,t,n){},1347:function(e,t,n){},"1e4b":function(e,t,n){},"216f":function(e,t,n){"use strict";var s=n("b1f6"),i=n.n(s);i.a},"22de":function(e,t,n){"use strict";var s=n("25be"),i=n.n(s);i.a},"25be":function(e,t,n){},3519:function(e,t,n){"use strict";var s=n("d365"),i=n.n(s);i.a},"56d7":function(e,t,n){"use strict";n.r(t);var s={};n.r(s),n.d(s,"websocketConnect",function(){return $e}),n.d(s,"websocketDisconnect",function(){return ze}),n.d(s,"subscribe",function(){return De}),n.d(s,"unsubscribe",function(){return He}),n.d(s,"getIpcams",function(){return Ve}),n.d(s,"openStreaming",function(){return je}),n.d(s,"closeStreaming",function(){return Ge});n("cadf"),n("551c"),n("f751"),n("097d");var i=n("415c"),c=n.n(i),a=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[e.isConnected?n("router-view"):e._e()],1)},o=[],l={name:"app",data:function(){return{isConnected:!1}},methods:{websocketConnect:function(){var e=this,t=window.location.hostname;window.CONSTANTS.IS_DEV&&(t="192.168.1.171"),this.services.websocketConnect(t,5555,function(){console.log("Connect"),e.isConnected=!0,e.stopInterval()},function(){console.log("Disconnect"),e.isConnected=!1,e.startInterval()},function(){console.log("Error")})},startInterval:function(){var e=this;this.checkInterval||(this.checkInterval=setInterval(function(){e.websocketConnect()},window.CONSTANTS.INTERVAL.WEBSOCKET_CONNECTION))},stopInterval:function(){this.checkInterval&&clearInterval(this.checkInterval),this.checkInterval=null}},created:function(){this.websocketConnect(),this.startInterval()}},u=l,d=(n("034f"),n("2877")),h=Object(d["a"])(u,r,o,!1,null,null,null),f=h.exports,m=n("8c4f"),p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"moi-main-container",attrs:{id:"Main"}},[n("div",{staticClass:"moi-main-frame"},[n("div",{staticClass:"moi-top-frame"},[n("div",{staticClass:"moi-top-panel"},e._l(e.buttonType,function(t,s){return n("Button",{key:s,attrs:{type:t,isSelected:e.selectedButtonType===t},on:{"select-button":e.handleSelectButton}})}),1)]),n("div",{ref:"contentFrame",staticClass:"moi-content-frame"},[0===e.selectedButtonType?n("list",{attrs:{selectedList:e.selectedShowScreenList},on:{"select-item":e.handleSelectedItem,"select-close-list":e.handleSelectedCloseList}}):e._e(),n("grid-screen",{attrs:{list:e.selectedShowScreenList}})],1)])])},v=[],S=(n("ac6a"),n("6762"),n("2fdb"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"list-main-container",attrs:{id:"list"}},[n("div",{staticClass:"list-main-frame"},[n("div",{staticClass:"list-top-frame"},[n("div",{staticClass:"list-text"},[e._v(e._s(e.title))]),n("div",{staticClass:"list-button",on:{click:e.handleCloseButton}},[n("CloseIcon",{attrs:{color:"white"}})],1)]),n("div",{staticClass:"list-content-frame"},e._l(e.ipcams,function(t){return n("list-item",{key:t.id,attrs:{ipcam:t,checked:e.isSelected(t.id)},on:{"select-item":e.handleSelectedItem}})}),1)])])}),w=[],E=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.isCheckMoi?n("div",{staticClass:"list-item-container",class:{checked:e.checked},attrs:{id:"list-item"},on:{click:e.handleSelectedItem}},[n("div",{staticClass:"list-item-frame"},[n("div",{staticClass:"list-item-checkbox"},[n("check-icon",{attrs:{selected:e.checked}})],1),n("div",{staticClass:"list-item-name-panel"},[n("div",{staticClass:"list-item-name-text",class:{checked:e.checked}},[e._v(e._s(e.ipcam.name))])])])]):e._e()},b=[],g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("svg",{staticStyle:{"enable-background":"new 0 0 426.667 426.667"},attrs:{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 426.667 426.667","xml:space":"preserve"}},[n("path",{staticClass:"check-icon",class:{checked:e.selected},attrs:{d:"M213.333,0C95.518,0,0,95.514,0,213.333s95.518,213.333,213.333,213.333\n        c117.828,0,213.333-95.514,213.333-213.333S331.157,0,213.333,0z M174.199,322.918l-93.935-93.931l31.309-31.309l62.626,62.622\n        l140.894-140.898l31.309,31.309L174.199,322.918z"}})])},T=[],C={name:"CheckIcon",props:{selected:{type:Boolean}}},y=C,N=(n("8e75"),Object(d["a"])(y,g,T,!1,null,null,null)),k=N.exports,I={name:"ListItem",components:{CheckIcon:k},props:{ipcam:{type:Object},checked:{type:Boolean}},methods:{handleSelectedItem:function(){this.$emit("select-item",this.ipcam.id)}},computed:{isCheckMoi:function(){return!!this.ipcam.custom&&this.ipcam.custom.is_visible_moi}},created:function(){console.log("Create list item ",this.ipcam)}},O=I,L=(n("0174"),Object(d["a"])(O,E,b,!1,null,null,null)),x=L.exports,R=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("svg",{attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 21.9 21.9","xmlns:xlink":"http://www.w3.org/1999/xlink","enable-background":"new 0 0 21.9 21.9"}},[n("path",{class:e.color,attrs:{d:"M14.1,11.3c-0.2-0.2-0.2-0.5,0-0.7l7.5-7.5c0.2-0.2,0.3-0.5,0.3-0.7s-0.1-0.5-0.3-0.7l-1.4-1.4C20,0.1,19.7,0,19.5,0  c-0.3,0-0.5,0.1-0.7,0.3l-7.5,7.5c-0.2,0.2-0.5,0.2-0.7,0L3.1,0.3C2.9,0.1,2.6,0,2.4,0S1.9,0.1,1.7,0.3L0.3,1.7C0.1,1.9,0,2.2,0,2.4  s0.1,0.5,0.3,0.7l7.5,7.5c0.2,0.2,0.2,0.5,0,0.7l-7.5,7.5C0.1,19,0,19.3,0,19.5s0.1,0.5,0.3,0.7l1.4,1.4c0.2,0.2,0.5,0.3,0.7,0.3  s0.5-0.1,0.7-0.3l7.5-7.5c0.2-0.2,0.5-0.2,0.7,0l7.5,7.5c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3l1.4-1.4c0.2-0.2,0.3-0.5,0.3-0.7  s-0.1-0.5-0.3-0.7L14.1,11.3z"}})])},A=[],M={name:"CloseIcon",props:{color:{type:String}}},P=M,B=(n("0557"),Object(d["a"])(P,R,A,!1,null,null,null)),U=B.exports,$={name:"List",components:{ListItem:x,CloseIcon:U},props:{selectedList:{type:Array}},data:function(){return{ipcams:[],title:"Selected videos"}},methods:{handleSelectedItem:function(e){this.$emit("select-item",e)},handleCloseButton:function(){this.$emit("select-close-list")},isSelected:function(e){return this._.includes(this.selectedList,e)}},created:function(){this.ipcams=this.$store.getters.getIpcams,console.log("Create list view ",this.ipcams)}},z=$,D=(n("f62b"),Object(d["a"])(z,S,w,!1,null,null,null)),H=D.exports,V=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"button-container",class:{selected:e.isSelected},attrs:{id:"button"},on:{click:e.handleSelectButton}},[n("div",{staticClass:"button-icon-panel"},[n("ListIcon",{directives:[{name:"show",rawName:"v-show",value:0===e.type,expression:"type === 0"}],attrs:{isSelected:e.isSelected}}),n("MenuIcon",{directives:[{name:"show",rawName:"v-show",value:1===e.type,expression:"type === 1"}],attrs:{isSelected:e.isSelected}})],1)])},j=[],G=(n("c5f6"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("svg",{attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512","xmlns:xlink":"http://www.w3.org/1999/xlink","enable-background":"new 0 0 512 512"}},[n("g",[n("g",{staticClass:"icon-color",class:{selected:e.isSelected}},[n("path",{attrs:{d:"m31.9,125.9h73.8v-73.7h-73.8v73.7h-7.10543e-15zm84.1,20.9h-94.6c-5.8,0-10.4-4.7-10.4-10.4v-94.7c0-5.8 4.7-10.4 10.4-10.4h94.6c5.8,0 10.4,4.7 10.4,10.4v94.6c0.1,5.8-4.6,10.5-10.4,10.5z"}}),n("path",{attrs:{d:"m490.6,99.5h-324.5c-5.8,0-10.4-4.7-10.4-10.4 0-5.8 4.7-10.4 10.4-10.4h324.5c5.8,0 10.4,4.7 10.4,10.4 0,5.7-4.7,10.4-10.4,10.4z"}}),n("path",{attrs:{d:"m31.9,292.9h73.8v-73.8h-73.8v73.8h-7.10543e-15zm84.1,20.8h-94.6c-5.8,0-10.4-4.7-10.4-10.4v-94.6c0-5.8 4.7-10.4 10.4-10.4h94.6c5.8,0 10.4,4.7 10.4,10.4v94.6c0.1,5.8-4.6,10.4-10.4,10.4z"}}),n("path",{attrs:{d:"m490.6,266.4h-324.5c-5.8,0-10.4-4.7-10.4-10.4 0-5.8 4.7-10.4 10.4-10.4h324.5c5.8,0 10.4,4.7 10.4,10.4 0,5.8-4.7,10.4-10.4,10.4z"}}),n("path",{attrs:{d:"m31.9,459.8h73.8v-73.8h-73.8v73.8h-7.10543e-15zm84.1,20.9h-94.6c-5.8,0-10.4-4.7-10.4-10.4v-94.6c0-5.8 4.7-10.4 10.4-10.4h94.6c5.8,0 10.4,4.7 10.4,10.4v94.6c0.1,5.7-4.6,10.4-10.4,10.4z"}}),n("path",{attrs:{d:"m490.6,433.4h-324.5c-5.8,0-10.4-4.7-10.4-10.4s4.7-10.4 10.4-10.4h324.5c5.8,0 10.4,4.7 10.4,10.4s-4.7,10.4-10.4,10.4z"}})])])])}),Y=[],F={name:"ListIcon",props:{isSelected:{type:Boolean,default:!1}}},W=F,Q=(n("c70d"),Object(d["a"])(W,G,Y,!1,null,null,null)),J=Q.exports,q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("svg",{staticStyle:{"enable-background":"new 0 0 512 512"},attrs:{version:"1.1",id:"Capa_1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 512 512","xml:space":"preserve"}},[n("g",{staticClass:"menu-icon",class:{selected:e.isSelected}},[n("g",[n("g",[n("path",{attrs:{d:"M176.792,0H59.208C26.561,0,0,26.561,0,59.208v117.584C0,209.439,26.561,236,59.208,236h117.584\n                    C209.439,236,236,209.439,236,176.792V59.208C236,26.561,209.439,0,176.792,0z M196,176.792c0,10.591-8.617,19.208-19.208,19.208\n                    H59.208C48.617,196,40,187.383,40,176.792V59.208C40,48.617,48.617,40,59.208,40h117.584C187.383,40,196,48.617,196,59.208\n                    V176.792z"}})])]),n("g",[n("g",[n("path",{attrs:{d:"M452,0H336c-33.084,0-60,26.916-60,60v116c0,33.084,26.916,60,60,60h116c33.084,0,60-26.916,60-60V60\n                    C512,26.916,485.084,0,452,0z M472,176c0,11.028-8.972,20-20,20H336c-11.028,0-20-8.972-20-20V60c0-11.028,8.972-20,20-20h116\n                    c11.028,0,20,8.972,20,20V176z"}})])]),n("g",[n("g",[n("path",{attrs:{d:"M176.792,276H59.208C26.561,276,0,302.561,0,335.208v117.584C0,485.439,26.561,512,59.208,512h117.584\n                    C209.439,512,236,485.439,236,452.792V335.208C236,302.561,209.439,276,176.792,276z M196,452.792\n                    c0,10.591-8.617,19.208-19.208,19.208H59.208C48.617,472,40,463.383,40,452.792V335.208C40,324.617,48.617,316,59.208,316h117.584\n                    c10.591,0,19.208,8.617,19.208,19.208V452.792z"}})])]),n("g",[n("g",[n("path",{attrs:{d:"M452,276H336c-33.084,0-60,26.916-60,60v116c0,33.084,26.916,60,60,60h116c33.084,0,60-26.916,60-60V336\n                    C512,302.916,485.084,276,452,276z M472,452c0,11.028-8.972,20-20,20H336c-11.028,0-20-8.972-20-20V336c0-11.028,8.972-20,20-20\n                    h116c11.028,0,20,8.972,20,20V452z"}})])])])])},K=[],X={name:"MenuIcon",props:{isSelected:{type:Boolean,default:!1}}},Z=X,ee=(n("216f"),Object(d["a"])(Z,q,K,!1,null,null,null)),te=ee.exports,ne={name:"Button",components:{ListIcon:J,MenuIcon:te},props:{type:{type:Number},isSelected:{type:Boolean,default:!1}},data:function(){return{iconColor:"default"}},methods:{handleSelectButton:function(){this.$emit("select-button",this.type)}},created:function(){console.log("Created button ",this.type)}},se=ne,ie=(n("8274"),Object(d["a"])(se,V,j,!1,null,null,null)),ce=ie.exports,ae=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"full-screen"}},[n("Player",{attrs:{src:e.ipcam.src}})],1)},re=[],oe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"playerContent",staticClass:"player-container"},[e.hasStreamingURL?n("div",{staticClass:"player-info-container"},[n("div",{staticClass:"player-info-name"},[e._v(e._s(e.ipcam.name))])]):e._e(),n("video",{ref:"videoPlayer",staticClass:"video-player",attrs:{controls:"controls",autoplay:"autoplay"}})])},le=[],ue=n("ba56"),de=n.n(ue),he={name:"Player",props:{id:{type:String,default:""},size:{type:Object,default:{}}},data:function(){return{options:{},url:"",ipcam:{},hls:null,src:""}},mounted:function(){this.ipcam=this.$store.getters.getIpcam(this.id),this.$refs.videoPlayer.height=this.size.height,this.$refs.videoPlayer.width=this.size.width,this._playMedia(this.id)},computed:{hasStreamingURL:function(){return!this._.isEmpty(this.url)}},beforeDestroy:function(){},watch:{size:function(){this.$refs.videoPlayer.height=this.size.height,this.$refs.videoPlayer.width=this.size.width}},methods:{_playMedia:function(e){var t=this;this.hls=new de.a,this.hls.attachMedia(this.$refs.videoPlayer),this.hls.on(de.a.Events.MANIFEST_PARSED,function(){t.$refs.videoPlayer.play()}),this.url=this.$store.getters.getStreamingURL(e),this.hls.loadSource(this.url)}},created:function(){var e=this;Ye.$on("openStreamURL",function(t){e.id===t&&e.hls&&e._playMedia(t)})}},fe=he,me=(n("6131"),Object(d["a"])(fe,oe,le,!1,null,null,null)),pe=me.exports,ve=(n("d8b2"),{name:"FullScreen",components:{Player:pe},props:{ipcam:{type:Object,default:{}}}}),_e=ve,Se=Object(d["a"])(_e,ae,re,!1,null,null,null),we=Se.exports,Ee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"grid-main-container",attrs:{id:"grid-screen"}},[n("div",{ref:"gridFrame",staticClass:"grid-main-frame"},e._l(e.list,function(t){return n("div",{key:t},[e.isMounted?n("Player",{attrs:{id:t,size:e.screenSize}}):e._e()],1)}),0)])},be=[],ge={name:"GridScreen",components:{Player:pe},props:{list:{type:Array}},data:function(){return{screenSize:{}}},methods:{_calculateSize:function(){var e=this.$refs.gridFrame.clientWidth,t=this.$refs.gridFrame.clientHeight,n=this._.size(this.list),s=n>1?2:1,i=Math.floor(n/2)+n%2;this.screenSize={width:e/s,height:t/i}}},computed:{isMounted:function(){return!this._.isEmpty(this.screenSize)}},created:function(){var e=this;console.log("create grid screen",this.list),window.addEventListener("resize",function(){setTimeout(function(){e._calculateSize()},1)})},watch:{list:function(){this._calculateSize()}}},Te=ge,Ce=(n("3519"),Object(d["a"])(Te,Ee,be,!1,null,null,null)),ye=Ce.exports,Ne={name:"Main",components:{List:H,Button:ce,FullScreen:we,GridScreen:ye},data:function(){return{buttonType:window.CONSTANTS.BUTTON_TYPE,selectedButtonType:-1,screenWidth:0,selectedShowScreenList:[]}},methods:{handleSelectButton:function(e){this.selectedButtonType===e?this.selectedButtonType=-1:this.selectedButtonType=e},handleSelectedItem:function(e){this._.includes(this.selectedShowScreenList,e)?(this.closeStreaming(e),this.selectedShowScreenList=this._.without(this.selectedShowScreenList,e)):this._.size(this.selectedShowScreenList)<window.CONSTANTS.MAX_SHOWING_SCREEN&&(this.selectedShowScreenList.push(e),this.openStreaming(e))},handleSelectedCloseList:function(){this.selectedButtonType=-1},openStreaming:function(e){var t=this;this.services.openStreaming([e],function(n){t._.isEmpty(n)||t._.forEach(n,function(n){n&&(t.$store.commit("addStreamingURL",n),Ye.$emit("openStreamURL",e))})})},closeStreaming:function(e){var t=this;this.services.closeStreaming([e],function(n){t._.isEmpty(n)||t._.forEach(n,function(n){t.$store.commit("removeStreamingURL",e)})})},_handleAdded:function(e){this.$store.getters.isIpcam(e)||this.$store.commit("addIpcam",e)},_handleUpdated:function(e){e.custom&&(e.custom.is_visible_moi||this._.includes(this.selectedShowScreenList,e.id)&&(this.selectedShowScreenList=this._.without(this.selectedShowScreenList,e.id)),this.$store.commit("updateIpcam",e))},_handleRemoved:function(e){this.$store.getters.isIpcam(e)&&this.$store.commit("removeIpcam",e.id)},_handleReopenStreaming:function(e){var t=this;this._.forEach(e,function(e){var n=_.first(_.keys(e));t._.includes(t.selectedShowScreenList,n)&&(t.$store.commit("addStreamingURL",e),Ye.$emit("openStreamURL",n))})},_subscribe:function(){var e=this;this.services.subscribe({added:function(t){e._handleAdded(t.v)},updated:function(t){e._handleUpdated(t.v)},removed:function(t){e._handleRemoved(t.v)},reopenStreaming:function(t){e._handleReopenStreaming(t.v)}},function(){})}},computed:{isShowGridScreen:function(){return this._.size(this.selectedShowScreenList)>0}},created:function(){var e=this;this._subscribe(),this.services.getIpcams(function(t){e.$store.commit("addIpcams",t)})}},ke=Ne,Ie=(n("22de"),Object(d["a"])(ke,p,v,!1,null,null,null)),Oe=Ie.exports;a["a"].use(m["a"]);var Le=new m["a"]({base:"/",mode:"history",routes:[{path:"/",name:"main",component:Oe,children:[]}]}),xe=n("2f62");a["a"].use(xe["a"]);var Re=new xe["a"].Store({state:{ipcams:{},streamingUrls:{}},getters:{getIpcams:function(e){return _.values(e.ipcams)},getIpcam:function(e){return function(t){return e.ipcams[t]}},isIpcam:function(e){return function(t){return!!e.ipcams[t]}},getAllStreamingURL:function(e){return _.values(e.streamingUrls)},getStreamingURL:function(e){return function(t){return e.streamingUrls[t]}}},mutations:{addIpcams:function(e,t){_.forEach(t,function(t){e.ipcams[t.id]=t})},addIpcam:function(e,t){e.ipcams[t.id]=t},updateIpcam:function(e,t){_.has(e.ipcams,t.id)&&_.extend(e.ipcams[t.id],t)},removeIpcam:function(e,t){_.has(ipcams,t)&&delete e.ipcams[t]},addStreamingURL:function(e,t){_.extend(e.streamingUrls,t)},removeStreamingURL:function(e,t){delete e.streamingUrls[t]}},actions:{}}),Ae=(n("d1a0"),n("6b54"),n("d225")),Me=n("b0b4"),Pe=(n("7e3c"),function(){function e(){Object(Ae["a"])(this,e),this._handler={},this._subscribeHandlers=null,this.socket=null,this.clientId=null}return Object(Me["a"])(e,[{key:"connect",value:function(e,t,n,s,i){var c=this;this.socket=new WebSocket("ws://".concat(e,":").concat(t,"/ws")),this.socket.onopen=n,this.socket.onerror=i,this.socket.onclose=s,this.socket.onmessage=function(e){c._onMessage(e)}}},{key:"disconnect",value:function(){this.socket&&this.socket.close()}},{key:"send",value:function(e){this.socket&&this.socket.send(JSON.stringify(e))}},{key:"call",value:function(e,t){var n=this._createRequestId();_.extend(e,{i:n}),this._registerHandler(n,t),this.send(e)}},{key:"subscribe",value:function(e,t){var n=this;this.call({e:window.CONSTANTS.REQUEST_TYPE.SUBSCRIBE,kwargs:{client_kind:"M"},_t:new Date/1e3},function(e){n.clientId=e,t()}),this._subscribeHandlers=e}},{key:"unsubscribe",value:function(){this.call({e:window.CONSTANTS.REQUEST_TYPE.UNSUBSCRIBE,kwargs:{client_id:this.clientId,client_kind:"M"},_t:new Date/1e3},function(){}),this._subscribeHandlers=null}},{key:"_createRequestId",value:function(){return Math.random().toString(36).substr(2,5)}},{key:"_registerHandler",value:function(e,t){this._handler[e]||(this._handler[e]=t)}},{key:"_authenticate",value:function(){if(this.socket){var e={};e.ident=_createRequestId(),e.value={name:"authenticate",args:"key",namespace:""};var t=JSON.stringify(e);this.send(t)}}},{key:"_onOpen",value:function(e){1===this.readyState&&this._authenticate()}},{key:"_onClose",value:function(e){}},{key:"_onMessage",value:function(e){var t=null;try{t=JSON.parse(e.data)}finally{t&&(_.has(t,"i")?this._handleResponse(t):(console.log("NNNNNNNNNNNNNNNNN",t),this._handleEvent(t)))}}},{key:"_handleResponse",value:function(e){var t=this._handler[e.i];t&&(t(e.v),delete this._handler[e.i])}},{key:"_handleEvent",value:function(e){if(e)switch(e.e){case window.CONSTANTS.EVENT_TYPE.ADDED:this._subscribeHandlers.added(e);break;case window.CONSTANTS.EVENT_TYPE.UPDATED:this._subscribeHandlers.updated(e);break;case window.CONSTANTS.EVENT_TYPE.REMOVED:this._subscribeHandlers.removed(e);break;case window.CONSTANTS.EVENT_TYPE.GET_DETECTED_LIST:this._subscribeHandlers.getDetectedList(e);break;case window.CONSTANTS.EVENT_TYPE.HUB_ONLINE:this._subscribeHandlers.hub_online(e);break;case window.CONSTANTS.EVENT_TYPE.HUB_OFFLINE:this._subscribeHandlers.hub_offline(e);break;case window.CONSTANTS.EVENT_TYPE.REFRESH:this._subscribeHandlers.refresh(e);break;case window.CONSTANTS.EVENT_TYPE.REOPEN_STREAMING:this._subscribeHandlers.reopenStreaming(e);break}}},{key:"_onError",value:function(e){console.log("Socket is error ",e)}}]),e}()),Be=new Pe,Ue=function(){return new Date/1e3},$e=function(e,t,n,s,i){Be.connect(e,t,n,s,i)},ze=function(){Be.disconnect()},De=function(e,t){Be.subscribe(e,t)},He=function(){Be.unsubscribe()},Ve=function(e){Be.call({e:window.CONSTANTS.REQUEST_TYPE.GET_DATA,kwargs:{kind:"ipcam"},_t:Ue()},e)},je=function(e,t){Be.call({e:window.CONSTANTS.REQUEST_TYPE.OPEN_STREAMING,kwargs:{ids:e},_t:Ue()},t)},Ge=function(e,t){Be.call({e:window.CONSTANTS.REQUEST_TYPE.CLOSE_STREAMING,kwargs:{ids:e},_t:Ue()},t)};n.d(t,"EventBus",function(){return Ye}),a["a"].config.productionTip=!1,a["a"].prototype.services=s;var Ye=new a["a"]({});a["a"].use(c.a),new a["a"]({router:Le,store:Re,render:function(e){return e(f)}}).$mount("#app")},6131:function(e,t,n){"use strict";var s=n("bf75"),i=n.n(s);i.a},"629d":function(e,t,n){},"64a9":function(e,t,n){},8274:function(e,t,n){"use strict";var s=n("1347"),i=n.n(s);i.a},"8e75":function(e,t,n){"use strict";var s=n("1e4b"),i=n.n(s);i.a},a269:function(e,t,n){},b1f6:function(e,t,n){},bf75:function(e,t,n){},bfa1:function(e,t,n){},c70d:function(e,t,n){"use strict";var s=n("bfa1"),i=n.n(s);i.a},d1a0:function(e,t){window.CONSTANTS={IS_DEV:!1,INTERVAL:{WEBSOCKET_CONNECTION:1e4},BUTTON_TYPE:{LIST:0,PARTITION:1},MAX_SHOWING_SCREEN:4,REQUEST_TYPE:{SUBSCRIBE:"subscribe",UNSUBSCRIBE:"unsubscribe",GET_INFO:"get_info",GET_MAP_FILE:"get_map_file",SET_MAP_FILE:"set_map_file",GET_DATA:"get_data",UPDATE_DATA:"update_data",GET_DETECTED_LIST:"get_detected_list",OPEN_STREAMING:"open_stream",CLOSE_STREAMING:"close_stream"},EVENT_TYPE:{ADDED:"added",UPDATED:"updated",REMOVED:"removed",GET_DETECTED_LIST:"detected",HUB_ONLINE:"on",HUB_OFFLINE:"off",REFRESH:"refresh",REOPEN_STREAMING:"reopen_stream"}}},d365:function(e,t,n){},f62b:function(e,t,n){"use strict";var s=n("629d"),i=n.n(s);i.a}});
//# sourceMappingURL=app.9b12cb61.js.map